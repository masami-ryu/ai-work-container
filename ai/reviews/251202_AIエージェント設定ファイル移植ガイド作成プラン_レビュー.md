# AIエージェント設定ファイル移植ガイド作成プラン レビュー

作成日: 2025年12月02日
レビュアー: Plan Creator (Review Mode)
対象プラン: ai/plans/251202_AIエージェント設定ファイル移植ガイド作成プラン.md
ステータス: 反映済み

## 1. 概要
プランの全体的な構成は論理的であり、目的も明確です。特に、単一リポジトリだけでなく、フロントエンド・バックエンド分離構成を考慮している点は高く評価できます。
しかし、Serena MCPの複数プロジェクト設定（特に方法1）に関して、VS Code Copilot環境での技術的な実現可能性とリスクに重大な懸念があります。

## 2. 評価
| 項目 | 評価 | コメント |
|------|------|----------|
| 目的の明確性 | ◎ | 非常に明確 |
| 実現可能性 | △ | MCPサーバー多重定義によるツール競合のリスクあり |
| 網羅性 | ◯ | 必要なファイルは網羅されている |
| リスク管理 | △ | 技術的制約（MCP仕様）への考慮が不足 |

## 3. 主な指摘事項

### 3.1 MCPサーバー多重定義のリスク（方法1）
プランの「参考情報」および「Phase 3」では、「方法1: MCPサーバー定義を複数記述する」を推奨しています。
しかし、VS Code CopilotのMCPクライアントの仕様上、複数のサーバーが同名のツール（例: `mcp_serena_find_symbol`）を提供した場合、名前空間の衝突が発生する可能性が高いです。
現状のVS Code Copilotでは、ツール名にサーバー名のプレフィックスが自動付与される保証はなく、LLMが「どちらのサーバーのツールを実行すべきか」を区別できない、あるいは片方のツールしか認識されないリスクがあります。

**推奨アクション:**
- 「方法1」を推奨から外し、検証が必要な実験的アプローチとして扱うか、削除する。
- 代わりに、単一のSerenaサーバーインスタンスを使用し、`activate_project` ツールで動的にコンテキストを切り替える方法を推奨する。

### 3.2 Serenaのプロジェクト認識仕様の確認
Serenaの `activate_project` ツールは "Activates the project with the given name or path." と定義されています。これは、サーバー起動時に複数のプロジェクトを定義する必要はなく、実行時にパスを指定して切り替えられることを示唆しています。
`mcp.json` に複数のサーバー定義を書くよりも、1つのサーバー定義で運用する方がシンプルかつ安全です。

### 3.3 検証フェーズの欠如
ドキュメントを作成する前に、提案する設定（特に複数リポジトリ構成）が実際に動作するかを確認するステップが含まれていません。ドキュメント化してから「動かない」ことが判明するリスクがあります。

## 4. 改善提案

### プランへの追加・修正
1.  **Phase 2の前に「技術検証フェーズ」を追加**
    -   タスク: VS Code Copilotで同じMCPサーバーを2つ定義した場合の挙動確認（ツール名衝突の有無）
    -   タスク: 単一Serenaサーバーでの `activate_project` によるプロジェクト切り替え動作の確認

2.  **Phase 3の内容修正**
    -   検証結果に基づき、推奨する設定方法を見直す（おそらく「単一サーバー + 動的切り替え」または「親ディレクトリ指定」が主になるはず）。

3.  **リスク項目の追加**
    -   「MCPツール名の衝突により、複数サーバー構成が機能しないリスク」を追加。

## 5. 結論
プランの方向性は正しいですが、技術的な詳細（特にMCPの仕様）においてリスクがあります。
まずは小規模な検証を行い、その結果に基づいてドキュメントの方針（特に複数プロジェクト対応部分）を確定させるよう、プランを修正してください。
