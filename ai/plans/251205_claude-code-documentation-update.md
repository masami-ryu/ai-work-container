# Claude Code ドキュメント更新プラン

作成日: 2025年12月05日
作成者: Claude Code
ステータス: Draft

## 1. 概要

### 目的
PR #14で実施したClaude Code環境のパフォーマンス最適化内容を、プロジェクトドキュメントに正確に反映し、ユーザーが最新の設定を理解・活用できるようにする。

### スコープ
- 対象: `docs/claude-code-usage.md` の設定例とベストプラクティス
- 対象: `CLAUDE.md` のパフォーマンス関連情報
- 対象外: MCPセットアップガイド（`docs/claude-code-mcp-setup.md`）の基本構造

### 前提条件
- PR #14のパフォーマンス最適化が完了していること
- `.claude/settings.json` の最新版が確定していること
- エージェント設定（haiku化）が適用されていること

## 2. 要件と制約

| ID | 種別 | 内容 | 優先度 |
|----|------|------|--------|
| REQ-001 | 要件 | settings.json の設定例を最新版に更新 | 高 |
| REQ-002 | 要件 | パーミッション設定のベストプラクティスを追加 | 高 |
| REQ-003 | 要件 | 環境変数の更新内容を反映 | 高 |
| REQ-004 | 要件 | サブエージェントのモデル変更（haiku）を記載 | 中 |
| REQ-005 | 要件 | セッションフック軽量化の説明を追加 | 中 |
| CON-001 | 制約 | 既存ドキュメント構造を維持 | - |
| CON-002 | 制約 | 日本語での記述 | - |
| GUD-001 | ガイドライン | コード例は動作確認済みのものを使用 | - |

## 3. 実装ステップ

### Phase 1: claude-code-usage.md の更新
**目標**: 設定例とパフォーマンス関連情報を最新化

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-001 | settings.json設定例を更新（行133-150） | docs/claude-code-usage.md | 最新のパーミッション・環境変数・hooks設定を反映 | [ ] |
| TASK-002 | パーミッション設定のセクション追加 | docs/claude-code-usage.md | allow/ask/denyの使い分けガイドを記載 | [ ] |
| TASK-003 | サブエージェントセクション更新（行176-179） | docs/claude-code-usage.md | modelパラメータ（haiku）とMCPツール統合を記載 | [ ] |
| TASK-004 | Hooksセクション更新（行181-186） | docs/claude-code-usage.md | session-start.shの軽量化について説明 | [ ] |

### Phase 2: パフォーマンス最適化ガイドの追加
**目標**: ベストプラクティスとトラブルシューティングを充実

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-005 | パフォーマンス最適化セクション追加 | docs/claude-code-usage.md | 環境変数の推奨値・エージェントモデル選択基準を記載 | [ ] |
| TASK-006 | セキュリティのベストプラクティス追加 | docs/claude-code-usage.md | 最小権限の原則に基づくパーミッション設定例を記載 | [ ] |

### Phase 3: CLAUDE.md の更新
**目標**: プロジェクト固有の最適化情報を追加

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-007 | パフォーマンス設定の概要追加 | CLAUDE.md | 現在の最適化状況（haiku, 環境変数）を簡潔に記載 | [ ] |
| TASK-008 | カスタムコマンド/エージェント一覧更新 | CLAUDE.md | 最新のツール権限情報を反映 | [ ] |

## 4. テスト計画

| テストID | 種別 | 内容 | 期待結果 |
|----------|------|------|---------|
| TEST-001 | 記載検証 | settings.json例が実際の設定と一致するか確認 | 差分なし |
| TEST-002 | 動作確認 | ドキュメント記載のコマンド例を実行 | すべて成功 |
| TEST-003 | リンク確認 | 内部リンクが正しく機能するか確認 | すべてのリンクが有効 |
| TEST-004 | 整合性確認 | claude-code-usage.md と CLAUDE.md の記載が矛盾しないか確認 | 矛盾なし |

## 5. 成功基準

- [ ] settings.json の設定例が最新の実装（PR #14）と完全一致
- [ ] パーミッション設定（allow/ask/deny）のベストプラクティスが明記されている
- [ ] 環境変数の推奨値（MAX_THINKING_TOKENS=16000等）が記載されている
- [ ] サブエージェントのモデル選択（haiku vs sonnet）の説明がある
- [ ] すべてのコード例が動作確認済み
- [ ] ドキュメント間で情報の矛盾がない

## 6. リスクと対策

| ID | リスク | 影響度 | 発生確率 | 対策 |
|----|--------|--------|---------|------|
| RISK-001 | 設定変更により既存ユーザーの環境が動作しなくなる | 高 | 中 | 変更点を明示し、移行ガイドを記載 |
| RISK-002 | ドキュメントの更新漏れ | 中 | 中 | レビュー時に実設定とのdiffを確認 |
| RISK-003 | セキュリティのベストプラクティスが不十分 | 高 | 低 | Microsoft Learn等の公式ドキュメントを参照 |

## 7. 依存関係

- PR #14 がマージされていること（developブランチに最新設定が反映）
- `.claude/settings.json` が安定していること（追加変更がない）

## 8. 次のアクション

1. [ ] Phase 1: claude-code-usage.md の更新を実施
2. [ ] Phase 2: パフォーマンス最適化ガイドの追加
3. [ ] Phase 3: CLAUDE.md の更新
4. [ ] テスト計画の実行
5. [ ] レビュー依頼（PR作成）

---
*このプランは Plan Creator エージェントによって作成されました*
