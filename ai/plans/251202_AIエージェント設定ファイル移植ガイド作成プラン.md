# AIエージェント設定ファイル移植ガイド作成プラン

作成日: 2025年12月02日  
作成者: Plan Creator エージェント  
ステータス: レビュー済み（修正完了）

## 1. 概要

### 目的
`.github/agents` と `.vscode/mcp.json` を別のプロジェクトにコピーして、プロジェクトに合わせて調整するための手順ドキュメントを作成する。特にフロントエンド・バックエンドが分離したリポジトリ構成で、Serena MCPを使って横断的にコードベースを把握できるようにする。

### スコープ
- 対象: 
  - `.github/agents` 配下のエージェント定義ファイル
  - `.github/copilot-instructions.md`
  - `.vscode/mcp.json`
  - Serena MCPの複数プロジェクト設定
- 対象外: 
  - 各MCPサーバーのインストール手順（既存ドキュメント参照）
  - DevContainer設定

### 前提条件
- コピー先プロジェクトがGitで管理されていること
- VS Code環境でGitHub Copilot Chatが利用可能であること
- uvxがインストールされていること（Serena MCP使用時）

## 2. 要件と制約

| ID | 種別 | 内容 | 優先度 |
|----|------|------|--------|
| REQ-001 | 要件 | 単一リポジトリへの移植手順を提供 | 高 |
| REQ-002 | 要件 | フロントエンド・バックエンド分離構成への対応手順を提供 | 高 |
| REQ-003 | 要件 | Serena MCPで複数リポジトリを横断的に扱う設定方法を提供 | 高 |
| REQ-004 | 要件 | 各設定ファイルのカスタマイズポイントを明確化 | 中 |
| CON-001 | 制約 | 既存のドキュメント（serena-setup.md等）と重複を避ける | - |
| GUD-001 | ガイドライン | 具体的な例を含めてわかりやすく記述 | - |

## 3. 実装ステップ

### Phase 1: ドキュメント構成設計
**目標**: ドキュメントの構成と内容を決定する

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-001 | ドキュメントの章立てを決定 | - | 目次が確定している | [ ] |
| TASK-002 | 既存ドキュメントとの関係を整理 | docs/*.md | 参照関係が明確 | [ ] |

### Phase 2: 技術検証（追加）
**目標**: 複数リポジトリ構成での最適なSerena設定方法を確定する

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-002-A | MCPサーバー多重定義時の挙動検証 | .vscode/mcp.json | ツール名衝突の有無と実用性が確認されている | [ ] |
| TASK-002-B | activate_projectによる切り替え検証 | - | 単一サーバーでのプロジェクト切り替えがスムーズに行えるか確認 | [ ] |
| TASK-002-C | 推奨設定パターンの決定 | - | ドキュメントに記載する推奨構成（単一サーバー推奨など）が決定している | [ ] |

### Phase 3: 基本移植手順の作成
**目標**: 単一リポジトリへの移植手順を作成

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-003 | ファイルコピー手順の作成 | docs/agent-config-migration-guide.md | コピー手順が記載されている | [ ] |
| TASK-004 | mcp.jsonカスタマイズ手順の作成 | docs/agent-config-migration-guide.md | 各サーバー設定の調整ポイントが記載されている | [ ] |
| TASK-005 | agentsファイルカスタマイズ手順の作成 | docs/agent-config-migration-guide.md | エージェント設定の調整ポイントが記載されている | [ ] |
| TASK-006 | copilot-instructions.mdカスタマイズ手順の作成 | docs/agent-config-migration-guide.md | プロジェクト固有の指示の追加方法が記載されている | [ ] |

### Phase 4: 複数リポジトリ対応手順の作成
**目標**: Serena MCPで複数リポジトリを横断的に扱う設定方法を作成

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-007 | 推奨設定（単一サーバー+切り替え等）の手順作成 | docs/agent-config-migration-guide.md | 検証結果に基づいた推奨設定が記載されている | [ ] |
| TASK-008 | 代替設定（親ディレクトリ指定等）の手順作成 | docs/agent-config-migration-guide.md | 簡易的な設定方法が記載されている | [ ] |
| TASK-009 | プロジェクト切り替え方法の説明 | docs/agent-config-migration-guide.md | activate_projectツールの使用方法が記載されている | [ ] |
| TASK-010 | フロントエンド・バックエンド横断的な作業例 | docs/agent-config-migration-guide.md | 具体的なユースケースと指示例が記載されている | [ ] |

### Phase 5: チェックリストと補足情報の追加
**目標**: 移植作業を確実に完了させるための補助情報を追加

| タスクID | 内容 | 対象ファイル | 完了条件 | 状態 |
|----------|------|-------------|---------|------|
| TASK-011 | 移植完了チェックリストの作成 | docs/agent-config-migration-guide.md | 確認項目が網羅されている | [ ] |
| TASK-012 | トラブルシューティングセクションの作成 | docs/agent-config-migration-guide.md | よくある問題と解決策が記載されている | [ ] |
| TASK-013 | 既存ドキュメントへの参照リンクの追加 | docs/agent-config-migration-guide.md | serena-setup.md等への適切なリンクがある | [ ] |

## 4. ドキュメント構成案

```
# AIエージェント設定ファイル移植ガイド

## 1. 概要
- 目的
- 対象ファイル一覧
- 前提条件

## 2. 基本的な移植手順（単一リポジトリ）
### 2.1 ファイルのコピー
### 2.2 .vscode/mcp.json のカスタマイズ
  - context7（変更不要）
  - msdocs（変更不要）
  - github-mcp-server（PAT設定確認）
  - serena（プロジェクトパス調整）
### 2.3 .github/agents のカスタマイズ
  - 使用するツールの調整
  - プロジェクト固有の指示追加
### 2.4 .github/copilot-instructions.md のカスタマイズ
  - 言語設定
  - プロジェクト固有の規約

## 3. 複数リポジトリ構成への対応
### 3.1 推奨設定: 単一サーバーでの運用
  - mcp.json設定例
  - activate_projectによる切り替え
### 3.2 代替設定: 親ディレクトリを指定する
  - 適用条件
  - 設定例
### 3.3 ユースケース
  - フロントエンドからバックエンドAPIを調査
  - 両方のリポジトリにまたがる変更

## 4. チェックリスト
## 5. トラブルシューティング
## 6. 参考リンク
```

## 5. 成功基準

- [ ] 単一リポジトリへの移植手順が明確に記載されている
- [ ] 各設定ファイルのカスタマイズポイントが具体例とともに説明されている
- [ ] Serena MCPで複数リポジトリを扱う2つの方法が記載されている
- [ ] フロントエンド・バックエンド横断作業の具体的なユースケースが含まれている
- [ ] 移植完了チェックリストが含まれている
- [ ] 既存ドキュメント（serena-setup.md等）と整合性がとれている

## 6. リスクと対策

| ID | リスク | 影響度 | 発生確率 | 対策 |
|----|--------|--------|---------|------|
| RISK-001 | MCPツール名の衝突により、複数サーバー構成が機能しない | 高 | 高 | 検証フェーズで動作確認を行い、単一サーバー運用を基本とする |
| RISK-002 | 特定のプロジェクト構成でしか動作しない手順になる | 中 | 低 | 複数のパターン（モノレポ、完全分離等）を網羅 |
| RISK-003 | GitHub Copilot/VS Codeのアップデートで手順が陳腐化 | 低 | 中 | 更新日を明記し、定期的なレビューを促す注記を追加 |

## 7. 依存関係

- 既存ドキュメント: `docs/serena-setup.md`
- 既存ドキュメント: `docs/github-mcp.md`
- 設定ファイル: `.vscode/mcp.json`
- エージェント定義: `.github/agents/*.agent.md`

## 8. 参考情報

### Serena MCPの複数プロジェクト設定（要検証）

**方法1: MCPサーバー定義を複数記述する（非推奨の可能性あり）**
※ VS Code Copilotではツール名が衝突する可能性があるため、検証が必要。
```json
{
  "servers": {
    "serena-frontend": {
      "type": "stdio",
      "command": "uvx",
      "args": [
        "--from", "git+https://github.com/oraios/serena",
        "serena", "start-mcp-server",
        "--context", "ide-assistant",
        "--project", "/path/to/frontend"
      ]
    },
    "serena-backend": {
      "type": "stdio",
      "command": "uvx",
      "args": [
        "--from", "git+https://github.com/oraios/serena",
        "serena", "start-mcp-server",
        "--context", "ide-assistant",
        "--project", "/path/to/backend"
      ]
    }
  }
}
```

**方法2: 親ディレクトリを指定する（簡易策）**
```json
{
  "servers": {
    "serena": {
      "type": "stdio",
      "command": "uvx",
      "args": [
        "--from",
        "git+https://github.com/oraios/serena",
        "serena",
        "start-mcp-server",
        "--context",
        "ide-assistant",
        "--project",
        "/path/to/parent-directory"
      ]
    }
  }
}
```
※ 親ディレクトリにフロントエンドとバックエンドの両方が含まれる場合に使用

### プロジェクトの動的切り替え

Serenaの`activate_project`ツールを使用して、会話中にプロジェクトを切り替え可能：
- 「フロントエンドプロジェクトをアクティブにして」
- 「バックエンドのコードを分析するためにプロジェクトを切り替えて」

## 9. 次のアクション

1. [ ] Phase 1: ドキュメント構成の最終確認
2. [ ] Phase 2: 技術検証（MCPサーバー多重定義、activate_project動作）
3. [ ] Phase 3: 基本移植手順の作成
4. [ ] Phase 4: 複数リポジトリ対応手順の作成
5. [ ] Phase 5: チェックリストとトラブルシューティングの追加
6. [ ] 既存ドキュメント（serena-setup.md）との整合性レビュー

---
*このプランは Plan Creator エージェントによって作成されました*
