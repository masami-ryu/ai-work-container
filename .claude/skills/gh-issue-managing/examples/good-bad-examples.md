# Issue管理の良い例・悪い例

## 目次
- [Issue作成の例](#issue作成の例)
- [Issue更新の例](#issue更新の例)
- [ラベル運用の例](#ラベル運用の例)

---

## Issue作成の例

### 例1: バグ報告

#### 良い例

**入力**:
```
"ログイン画面でエラーメッセージが表示されないバグを報告するIssueを作成して"
```

**実行**:
```bash
gh issue create \
  --title "Bug: ログイン画面でエラーメッセージが表示されない" \
  --body "$(cat <<'EOF'
## 再現手順
1. ログイン画面にアクセス (https://example.com/login)
2. 無効なメールアドレス (invalid@) を入力
3. ログインボタンをクリック

## 期待動作
「メールアドレスの形式が正しくありません」というエラーメッセージが表示される

## 実際の動作
エラーメッセージが表示されず、画面が固まる

## 環境
- OS: Windows 11
- ブラウザ: Chrome 120.0.6099.130
- バージョン: v1.2.3

## スクリーンショット
[添付予定]
EOF
)" \
  --label "bug,priority:high"
```

**チェック観点**:
- [x] タイトルに種別（Bug）が明記されている
- [x] 再現手順が具体的（誰でも再現できる）
- [x] 期待動作と実際の動作が明確
- [x] 環境情報が含まれている
- [x] 適切なラベル（bug, priority:high）が選択されている

#### 悪い例

**入力**:
```
"バグを報告して"
```

**実行**:
```bash
gh issue create \
  --title "バグ" \
  --body "ログインがおかしい"
```

**問題点**:
- [ ] タイトルが抽象的（何のバグか不明）
- [ ] 再現手順がない
- [ ] 期待動作と実際の動作が不明
- [ ] 環境情報がない
- [ ] ラベルが指定されていない

---

### 例2: 機能要求

#### 良い例

**入力**:
```
"ダークモード機能を追加する要求を作成して"
```

**実行**:
```bash
gh issue create \
  --title "Feature: ダークモード切り替えボタンの追加" \
  --body "$(cat <<'EOF'
## 背景・目的
夜間の利用時に目の負担を軽減するため、ダークモードに対応したい。

## 提案内容
1. 設定画面にダークモード切り替えトグルを追加
2. システム設定（OS）のダークモード設定を自動検出
3. ユーザーの選択を localStorage に保存

## 期待効果
- ユーザーの目の負担軽減（特に夜間利用時）
- アクセシビリティの向上
- ユーザー満足度の向上

## 参考
- Material Design Dark Theme: https://material.io/design/color/dark-theme.html
- 類似アプリの実装例: https://...

## 実装範囲
- [ ] ダークモードのカラーパレット定義
- [ ] CSS変数の切り替え機能
- [ ] 設定画面のトグルUI
- [ ] localStorage への保存・読み込み
- [ ] システム設定の自動検出
EOF
)" \
  --label "feature,priority:medium"
```

**チェック観点**:
- [x] タイトルに種別（Feature）と具体的な内容が明記
- [x] 背景・目的が明確
- [x] 提案内容が具体的
- [x] 期待効果が記載されている
- [x] 参考資料へのリンクがある
- [x] 実装範囲が明確

#### 悪い例

**入力**:
```
"ダークモードを追加して"
```

**実行**:
```bash
gh issue create \
  --title "ダークモード" \
  --body "ダークモードが欲しい"
```

**問題点**:
- [ ] タイトルが不完全（種別不明、要求が不明確）
- [ ] 背景・目的が不明
- [ ] 提案内容が抽象的（どう実装するか不明）
- [ ] 期待効果が記載されていない
- [ ] 参考資料がない
- [ ] 実装範囲が不明

---

## Issue更新の例

### 例3: ラベル追加

#### 良い例

**入力**:
```
"Issue #15 の調査が完了したので、ステータスを更新して"
```

**実行前の確認**:
```bash
# 現在のIssue状態を確認
gh issue view 15
```

**実行**:
```bash
# 調査完了を示すラベルを追加し、調査中ラベルを削除
gh issue edit 15 \
  --remove-label "status:investigating" \
  --add-label "status:in-progress"

# 進捗をコメントで記録
gh issue comment 15 --body "調査完了。原因はXXXであることが判明。修正作業を開始します。"
```

**チェック観点**:
- [x] 更新前にIssueの現在の状態を確認
- [x] 適切なラベルを削除・追加
- [x] 進捗をコメントで記録（ステークホルダーへの通知）
- [x] ラベル変更の理由が明確

#### 悪い例

**入力**:
```
"Issue #15 のラベルを変更して"
```

**実行**:
```bash
# 現在の状態を確認せずにラベル追加
gh issue edit 15 --add-label "status:in-progress"
```

**問題点**:
- [ ] 更新前の状態確認がない
- [ ] 古いラベル（status:investigating）が残る可能性
- [ ] 進捗コメントがない（ステークホルダーに通知されない）
- [ ] ラベル変更の理由が不明

---

### 例4: アサイン変更

#### 良い例

**入力**:
```
"Issue #20 を developer2 にアサインして（developer1 が多忙のため）"
```

**実行前の確認**:
```bash
# 現在のアサイン状態を確認
gh issue view 20

# developer2 がリポジトリにアクセス権を持っているか確認
gh api repos/:owner/:repo/collaborators/developer2
```

**実行**:
```bash
# アサイン変更
gh issue edit 20 \
  --remove-assignee developer1 \
  --add-assignee developer2

# 変更理由をコメント
gh issue comment 20 --body "@developer1 が多忙のため、@developer2 にアサイン変更します。よろしくお願いします。"
```

**チェック観点**:
- [x] 現在のアサイン状態を確認
- [x] 新しいアサイン先（developer2）のアクセス権を確認
- [x] アサイン変更の理由をコメントで記録
- [x] 関係者にメンション（@developer1, @developer2）で通知

#### 悪い例

**入力**:
```
"Issue #20 を developer2 にアサインして"
```

**実行**:
```bash
# 確認なしでアサイン変更
gh issue edit 20 --add-assignee developer2
```

**問題点**:
- [ ] 現在のアサイン状態を確認していない（developer1 が残る可能性）
- [ ] developer2 のアクセス権を確認していない
- [ ] 変更理由のコメントがない
- [ ] 関係者への通知がない

---

### 例5: Issueクローズ

#### 良い例

**入力**:
```
"Issue #15 の修正が完了したので、クローズして"
```

**実行前の確認**:
```bash
# Issue詳細を確認
gh issue view 15

# 関連PRがマージ済みか確認
gh pr list --state merged --search "fixes #15"
```

**実行**:
```bash
# クローズ理由をコメントで記録
gh issue comment 15 --body "$(cat <<'EOF'
PR #123 でバグ修正完了しました。

## 修正内容
- エラーメッセージ表示のバリデーションロジックを追加
- テストケースを追加（test/login.spec.ts）

## リリース予定
v1.2.4 で2025-12-25にリリース予定です。

お疲れさまでした！
EOF
)"

# Issueをクローズ
gh issue close 15
```

**チェック観点**:
- [x] クローズ前にIssue詳細を確認
- [x] 関連PRのマージ状態を確認
- [x] クローズ理由を詳細にコメント
- [x] 修正内容とリリース予定を明記
- [x] ステークホルダーへの感謝を記載

#### 悪い例

**入力**:
```
"Issue #15 をクローズして"
```

**実行**:
```bash
# コメントなしでクローズ
gh issue close 15
```

**問題点**:
- [ ] クローズ前の確認がない
- [ ] 関連PRのマージ状態を確認していない
- [ ] クローズ理由のコメントがない
- [ ] 修正内容やリリース予定が不明
- [ ] ステークホルダーへの通知がない

---

## ラベル運用の例

### 例6: バグの優先度判定

#### 良い例（Critical）

**状況**: 本番環境でログイン機能が完全に停止

**判定**:
```
優先度判定チェックリスト:
- [x] システム停止や重大なセキュリティ問題 → priority:critical
- [ ] 主要機能に影響、多数のユーザーに影響
- [ ] 軽微な機能に影響、一部のユーザーに影響
- [ ] UI/UXの改善、影響範囲が限定的
```

**実行**:
```bash
gh issue create \
  --title "CRITICAL: 本番環境でログイン機能が停止" \
  --body "..." \
  --label "bug,priority:critical"
```

**チェック観点**:
- [x] タイトルに「CRITICAL」を明記
- [x] 優先度判定の根拠が明確（システム停止）
- [x] 適切なラベル（priority:critical）を選択

#### 良い例（High）

**状況**: ユーザー検索機能が遅く、多数のユーザーに影響

**判定**:
```
優先度判定チェックリスト:
- [ ] システム停止や重大なセキュリティ問題
- [x] 主要機能に影響、多数のユーザーに影響 → priority:high
- [ ] 軽微な機能に影響、一部のユーザーに影響
- [ ] UI/UXの改善、影響範囲が限定的
```

**実行**:
```bash
gh issue create \
  --title "Bug: ユーザー検索のレスポンスが遅い（5秒以上）" \
  --body "..." \
  --label "bug,priority:high"
```

**チェック観点**:
- [x] 優先度判定の根拠が明確（主要機能、多数のユーザー）
- [x] 具体的な症状を記載（5秒以上）
- [x] 適切なラベル（priority:high）を選択

#### 悪い例

**状況**: 軽微なUI不具合だが、判定が不適切

**実行**:
```bash
gh issue create \
  --title "ボタンの色がおかしい" \
  --body "..." \
  --label "bug,priority:critical"  # ❌ 不適切
```

**問題点**:
- [ ] 優先度判定が過大（UI不具合はpriority:lowが妥当）
- [ ] 判定根拠が不明
- [ ] タイトルが抽象的

---

### 例7: 複数ラベルの適切な組み合わせ

#### 良い例

**状況**: ダークモード機能の要求（中優先度、レビュー待ち）

**実行**:
```bash
gh issue create \
  --title "Feature: ダークモード切り替えボタンの追加" \
  --body "..." \
  --label "feature,priority:medium,status:needs-review"
```

**チェック観点**:
- [x] 種別ラベル（feature）が1つ
- [x] 優先度ラベル（priority:medium）が1つ
- [x] ステータスラベル（status:needs-review）が適切
- [x] ラベルの組み合わせに矛盾がない

#### 悪い例

**実行**:
```bash
gh issue create \
  --title "ダークモード" \
  --body "..." \
  --label "bug,feature,priority:high,priority:critical"  # ❌ 不適切
```

**問題点**:
- [ ] 種別ラベルが複数（bug と feature は共存しない）
- [ ] 優先度ラベルが複数（priority:high と priority:critical は共存しない）
- [ ] ラベルの組み合わせに矛盾がある

---

## まとめ

### 良いIssue管理の特徴

1. **具体性**: タイトル、本文、ラベルがすべて具体的
2. **検証**: 作成・更新前に必ず検証を実施
3. **コミュニケーション**: ステークホルダーへの適切な通知
4. **エビデンス**: 判断の根拠を明記
5. **一貫性**: ラベル運用ルールに従う

### 悪いIssue管理の特徴

1. **抽象性**: タイトルや本文が抽象的で理解困難
2. **無検証**: 確認なしで作成・更新
3. **無通知**: ステークホルダーへの通知なし
4. **無根拠**: 判断の根拠が不明
5. **不整合**: ラベルの組み合わせに矛盾
