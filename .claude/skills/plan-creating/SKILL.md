---
name: plan-creating
description: 実行可能なプランを作成する専門スキル。タスク分析・設計・プラン策定（Express/Standard/Comprehensive）、プランレビュー、プラン修正を担当。
allowed-tools: [Read, Grep, Glob, WebFetch, Write, Edit]
---

# Plan Creating

## 概要

このスキルはタスクの分析から実行可能なプランの作成までを担当する。タスク規模に応じて適切なワークフローを選択し、具体的なアクションアイテムに変換し、品質チェックリストで検証した後、`ai/plans/`に保存する。

## 主要機能

- ワークフロー選択（Express/Standard/Comprehensive）
- プラン作成プロセスの実行
- プランレビュープロセスの実行
- プラン修正プロセスの実行
- 品質チェックリストによる検証

## 使用方法

### ワークフロー選択

タスクの規模に応じて適切なワークフローを選択。詳細は各ワークフローファイルを参照:

- **Express（簡易プラン）**: [workflows/express.md](workflows/express.md)
  - 変更対象が2ファイル以下、影響範囲が限定的
  - 例: READMEの更新、1-2ファイルの変更

- **Standard（標準プラン）**: [workflows/standard.md](workflows/standard.md)
  - 中程度の複雑さ、3-10ファイルに影響
  - 例: 新機能追加、複数ファイルのリファクタリング

- **Comprehensive（詳細プラン）**: [workflows/comprehensive.md](workflows/comprehensive.md)
  - アーキテクチャ変更、多数のファイルに影響
  - 例: マイクロサービス化、大規模リアーキテクチャ

### プラン作成プロセス

1. **タスクの目的を明確化**
   - ユーザーの要求を正確に理解
   - スコープと期待される成果を定義

2. **必要情報を収集**
   - `Grep`/`Glob`でコードベースを検索
   - 関連ファイルと既存パターンを把握
   - 依存関係を分析

3. **ベストプラクティスを調査**
   - `WebFetch`で最新情報を取得
   - 業界標準の設計パターンを参照

4. **具体的なステップに分解**
   - 実行可能なアクションアイテムに変換
   - Phase/タスク単位で整理
   - 完了条件を明記

5. **品質チェックリストで検証**
   - 完全性、アクション可能性、測定可能性を確認

6. **プランを出力**
   - `ai/plans/YYMMDD_[概要].md`に保存

### プランレビュープロセス

1. 作成したプランを詳細に読み込み、全体の構成と目的を理解
2. `WebFetch`でベストプラクティスを調査し妥当性を評価
3. 改善点・修正点を特定し具体的なフィードバックを提供
4. 必要に応じてプランの再構成を提案
5. レビュー結果を `ai/reviews/`に保存

### プラン修正プロセス

1. **修正箇所の特定**
   - レビュー結果や追加情報から修正が必要な箇所を特定
   - 影響範囲を評価（局所的 vs 全体的）

2. **再調査**（必要な場合）
   - 最新情報を再取得
   - 関連コードの再確認

3. **修正方針の決定**
   - 複数案がある場合は最も効果的な案を選択
   - トレードオフを明示

4. **修正の実施**
   - 局所的修正: 該当セクションのみ更新（`Edit`ツール）
   - 全体的修正: プラン全体を再構成（`Write`ツール）

5. **再検証**
   - 品質チェックリストで検証
   - 変更履歴をプランに追記

6. **保存**
   - 同一ファイルを更新（ステータスを変更）
   - または新バージョンとして保存（v2, v3...）

## Examples

**例1: Express ワークフロー（簡易タスク）**
```
User: "READMEに新機能のドキュメントを追加するプランを作成して"
Assistant:
1. ワークフロー選択: Express（1ファイル変更）
2. 情報収集: README.mdを確認
3. プラン作成: 簡潔なプラン作成
4. 出力: ai/plans/YYMMDD_readme-update.md
```

**例2: Standard ワークフロー（中規模タスク）**
```
User: "認証機能を追加するプランを作成して"
Assistant:
1. ワークフロー選択: Standard（5-10ファイル影響）
2. 目的理解: 認証の要件を確認
3. 情報収集: 既存の認証パターンを確認
4. 設計検討: 認証フローを設計
5. プラン作成: Phase別に整理
6. 検証: 品質チェックリスト
7. 出力: ai/plans/YYMMDD_authentication-feature.md
```

**例3: Comprehensive ワークフロー（大規模タスク）**
```
User: "マイクロサービスアーキテクチャに移行するプランを作成して"
Assistant:
1. ワークフロー選択: Comprehensive（多数ファイル影響）
2. 目的理解: 移行の目的と制約を確認
3. 詳細調査: 現行システムの依存関係を分析
4. 設計検討: マイクロサービスの境界を設計
5. リスク分析: 移行リスクを評価
6. プラン作成: Phase別に詳細なステップを作成
7. 複数回検証: 各Phase完了時に検証
8. 出力: ai/plans/YYMMDD_microservices-migration.md
```

**例4: プランレビュー**
```
User: "ai/plans/YYMMDD_task.mdをレビューして"
Assistant:
1. プランを読み込み
2. ベストプラクティスを調査
3. 改善点を特定
4. レビュー結果をai/reviews/に保存
```

**例5: プラン修正**
```
User: "レビュー結果を反映してプランを修正して"
Assistant:
1. レビュー結果を確認
2. 修正箇所を特定（局所的）
3. Editツールで該当セクションを更新
4. 再検証
5. 変更履歴を追記
```

## Guidelines

### 情報収集完了の判断基準

| 項目 | 確認方法 |
|------|---------|
| 対象ファイルの特定 | Glob/Grep で検索済み |
| 既存パターンの把握 | 類似実装を確認済み |
| 依存関係の理解 | 参照関係を確認済み |
| 技術的制約の把握 | ドキュメントから確認済み |
| ベストプラクティス | WebFetchで取得済み |

### 品質チェックリスト

#### 検証タイミング
- **Expressワークフロー**: プラン作成直後に1回
- **Standardワークフロー**: 設計検討後とプラン作成後の2回
- **Comprehensiveワークフロー**: 各フェーズ完了時に検証

#### チェック項目
1. **完全性**: すべての要件がプランに反映されているか
2. **アクション可能性**: 各タスクは具体的なアクション動詞で始まるか
3. **測定可能性**: 完了条件は客観的に判断可能か
4. **依存関係**: タスク間の依存が正しく反映されているか
5. **リスク対応**: 主要なリスクへの対策が含まれているか

#### 検証結果の対応
- すべてチェック通過 → プラン出力
- 1-2項目の問題 → 該当部分を修正して再検証
- 3項目以上の問題 → プラン全体を見直し

### 出力形式

- **保存先**: `ai/plans/YYMMDD_[概要].md`
- **テンプレート**: `ai/templates/plan-template.md`を参照
- **言語**: 日本語

#### 必須セクション
1. ヘッダー: タスク名、作成日、ステータス
2. 概要: 目的、スコープ、前提条件
3. 要件と制約: 表形式
4. 実装ステップ: Phase別、測定可能な完了条件
5. 成功基準: チェックリスト形式
6. 次のアクション: 具体的な次のステップ

### プラン出力例（Expressワークフロー）

```markdown
# README更新プラン

作成日: 2025年12月10日
作成者: Plan Creator
ステータス: Draft

## 1. 概要
### 目的
READMEに新機能のドキュメントを追加する。

### スコープ
- 対象: README.md
- 対象外: 他のドキュメントファイル

## 2. 要件と制約
| ID | 種別 | 内容 | 優先度 |
|----|------|------|--------|
| REQ-001 | 要件 | 新機能の使用方法を追加 | 高 |

## 3. 実装ステップ
| タスクID | 内容 | 完了条件 | 状態 |
|----------|------|---------|------|
| TASK-001 | 使用方法セクションを追加 | セクションが存在する | [ ] |

## 4. 成功基準
- [ ] 新機能の使用方法が記載されている
```

## Limitations

- ソースコードの直接編集は行わない
- プランファイル（.md）の作成・編集のみ
- レビュー結果は `ai/reviews/`に出力
- WebFetchの利用可能性に依存（外部ドキュメント検索）

## Version History

- **1.1.0** (2025-12-20): Progressive Disclosure適用（ワークフロー詳細を分離、時間推定を削除、SKILL.md簡略化）
- **1.0.0** (2025-12-20): 初版リリース
